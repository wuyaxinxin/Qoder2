# äº‘æ•ˆï¼ˆYunxiaoï¼‰å·¥å…·ä½¿ç”¨æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬æŒ‡å—å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨äº‘æ•ˆå¹³å°çš„å„ç§å·¥å…·åŠŸèƒ½ï¼ŒåŒ…æ‹¬é¡¹ç›®ç®¡ç†ã€ä»£ç ç®¡ç†ã€æµæ°´çº¿ç­‰æ ¸å¿ƒåŠŸèƒ½ã€‚

## ğŸ”§ å‰ç½®å‡†å¤‡

### è®¤è¯é…ç½®
ä½¿ç”¨äº‘æ•ˆå·¥å…·å‰éœ€è¦é…ç½®è®¿é—®å‡­è¯ï¼š

1. **ç™»å½•äº‘æ•ˆç®¡ç†åå°** - https://devops.aliyun.com/
2. **è·å–ä¸ªäººè®¿é—®ä»¤ç‰Œï¼ˆPersonal Access Tokenï¼‰**
   - è¿›å…¥ä¸ªäººè®¾ç½® â†’ è®¿é—®ä»¤ç‰Œ
   - åˆ›å»ºæ–°ä»¤ç‰Œå¹¶ä¿å­˜
3. **è·å–ç»„ç»‡ID**
   - è¿›å…¥ç»„ç»‡è®¾ç½® â†’ åŸºæœ¬ä¿¡æ¯
   - å¤åˆ¶ç»„ç»‡ID
4. **é…ç½®å‡­è¯**
   - åœ¨ IDE ä¸­é…ç½®äº‘æ•ˆæ’ä»¶
   - æˆ–è®¾ç½®ç¯å¢ƒå˜é‡

---

## ğŸ¯ å®é™…ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1: è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯

**å·¥å…·åç§°**: `mcp_yunxiao_get_current_user`

**ç”¨é€”**: éªŒè¯èº«ä»½ã€è·å–ç”¨æˆ·ID

**è°ƒç”¨å‚æ•°**:
```json
{
  "random_string": "demo"
}
```

**è¿”å›ç¤ºä¾‹**:
```json
{
  "id": "user123",
  "name": "å¼ ä¸‰",
  "email": "zhangsan@example.com",
  "accountId": "account456"
}
```

**ä½¿ç”¨åœºæ™¯**:
- ç¡®è®¤å½“å‰ç™»å½•ç”¨æˆ·
- è·å–ç”¨æˆ·IDç”¨äºåç»­æ“ä½œ
- éªŒè¯ä»¤ç‰Œæ˜¯å¦æœ‰æ•ˆ

---

### ç¤ºä¾‹2: è·å–ç»„ç»‡ä¿¡æ¯

**å·¥å…·åç§°**: `mcp_yunxiao_get_current_organization_info`

**ç”¨é€”**: è·å–ç»„ç»‡IDå’ŒåŸºæœ¬ä¿¡æ¯

**è°ƒç”¨å‚æ•°**:
```json
{
  "random_string": "demo"
}
```

**è¿”å›ç¤ºä¾‹**:
```json
{
  "organizationId": "org789",
  "organizationName": "ç¤ºä¾‹å…¬å¸",
  "userId": "user123"
}
```

**ä½¿ç”¨åœºæ™¯**:
- è·å–åç»­æ“ä½œå¿…éœ€çš„ organizationId
- ç¡®è®¤å½“å‰æ‰€å±ç»„ç»‡

---

### ç¤ºä¾‹3: æŸ¥è¯¢é¡¹ç›®åˆ—è¡¨

**å·¥å…·åç§°**: `mcp_yunxiao_search_projects`

**ç”¨é€”**: æœç´¢å’Œç­›é€‰äº‘æ•ˆé¡¹ç›®

**è°ƒç”¨å‚æ•°**:
```json
{
  "organizationId": "org789",
  "page": 1,
  "perPage": 10,
  "scenarioFilter": "participate"
}
```

**scenarioFilter é€‰é¡¹**:
- `participate` - æˆ‘å‚ä¸çš„é¡¹ç›®
- `manage` - æˆ‘ç®¡ç†çš„é¡¹ç›®
- `favorite` - æˆ‘æ”¶è—çš„é¡¹ç›®

**è¿”å›ç¤ºä¾‹**:
```json
{
  "result": [
    {
      "id": "project001",
      "name": "å­¦ç”Ÿç®¡ç†ç³»ç»Ÿ",
      "identifier": "student-sys",
      "status": "ACTIVE",
      "creator": "user123"
    }
  ],
  "totalCount": 25,
  "page": 1
}
```

**ä½¿ç”¨åœºæ™¯**:
- æŸ¥çœ‹æˆ‘å‚ä¸çš„æ‰€æœ‰é¡¹ç›®
- è·å–é¡¹ç›®IDç”¨äºå·¥ä½œé¡¹æŸ¥è¯¢
- é¡¹ç›®ç®¡ç†å’Œç»Ÿè®¡

---

### ç¤ºä¾‹4: æœç´¢å·¥ä½œé¡¹

**å·¥å…·åç§°**: `mcp_yunxiao_search_workitems`

**ç”¨é€”**: æŸ¥è¯¢éœ€æ±‚ã€ä»»åŠ¡ã€ç¼ºé™·ç­‰å·¥ä½œé¡¹

**è°ƒç”¨å‚æ•°**:
```json
{
  "organizationId": "org789",
  "spaceId": "project001",
  "category": "Task",
  "assignedTo": "self",
  "page": 1,
  "perPage": 20
}
```

**category ç±»å‹**:
- `Req` - éœ€æ±‚
- `Task` - ä»»åŠ¡
- `Bug` - ç¼ºé™·

**è¿”å›ç¤ºä¾‹**:
```json
{
  "result": [
    {
      "id": "workitem001",
      "subject": "ä¼˜åŒ–æŸ¥è¯¢æ€§èƒ½",
      "category": "Task",
      "status": "è¿›è¡Œä¸­",
      "assignedTo": "user123",
      "sprint": "è¿­ä»£1"
    }
  ],
  "totalCount": 15
}
```

**ä½¿ç”¨åœºæ™¯**:
- æŸ¥çœ‹æˆ‘çš„ä»»åŠ¡åˆ—è¡¨
- è·Ÿè¸ªBugå¤„ç†è¿›åº¦
- ç»Ÿè®¡éœ€æ±‚å®Œæˆæƒ…å†µ

---

### ç¤ºä¾‹5: è·å–ä»£ç ä»“åº“åˆ—è¡¨

**å·¥å…·åç§°**: `mcp_yunxiao_list_repositories`

**ç”¨é€”**: æŸ¥è¯¢Codeupä»£ç ä»“åº“

**è°ƒç”¨å‚æ•°**:
```json
{
  "organizationId": "org789",
  "page": 1,
  "perPage": 10,
  "search": "student"
}
```

**è¿”å›ç¤ºä¾‹**:
```json
{
  "result": [
    {
      "id": "repo001",
      "name": "student-management",
      "path": "org789/student-management",
      "httpUrl": "https://codeup.aliyun.com/org789/student-management.git",
      "defaultBranch": "master"
    }
  ]
}
```

**ä½¿ç”¨åœºæ™¯**:
- æµè§ˆç»„ç»‡çš„ä»£ç ä»“åº“
- è·å–ä»“åº“åœ°å€è¿›è¡Œå…‹éš†
- ç®¡ç†ä»£ç æƒé™

---

### ç¤ºä¾‹6: æŸ¥è¯¢æµæ°´çº¿åˆ—è¡¨

**å·¥å…·åç§°**: `mcp_yunxiao_list_pipelines`

**ç”¨é€”**: æŸ¥è¯¢CI/CDæµæ°´çº¿åŠçŠ¶æ€

**è°ƒç”¨å‚æ•°**:
```json
{
  "organizationId": "org789",
  "page": 1,
  "perPage": 10,
  "statusList": "SUCCESS,RUNNING,FAIL"
}
```

**statusList é€‰é¡¹**:
- `SUCCESS` - æˆåŠŸ
- `RUNNING` - è¿è¡Œä¸­
- `FAIL` - å¤±è´¥
- `CANCELED` - å·²å–æ¶ˆ
- `WAITING` - ç­‰å¾…ä¸­

**è¿”å›ç¤ºä¾‹**:
```json
{
  "result": [
    {
      "pipelineId": "pipeline001",
      "name": "å­¦ç”Ÿç³»ç»Ÿéƒ¨ç½²",
      "status": "SUCCESS",
      "createTime": "2025-10-16T10:00:00Z",
      "creator": "user123"
    }
  ]
}
```

**ä½¿ç”¨åœºæ™¯**:
- ç›‘æ§æ„å»ºçŠ¶æ€
- æŸ¥çœ‹éƒ¨ç½²å†å²
- åˆ†æå¤±è´¥åŸå› 

---

### ç¤ºä¾‹7: åˆ›å»ºå·¥ä½œé¡¹

**å·¥å…·åç§°**: `mcp_yunxiao_create_work_item`

**ç”¨é€”**: åˆ›å»ºæ–°çš„ä»»åŠ¡ã€éœ€æ±‚æˆ–ç¼ºé™·

**è°ƒç”¨å‚æ•°**:
```json
{
  "organizationId": "org789",
  "spaceId": "project001",
  "subject": "ä¼˜åŒ–å­¦ç”Ÿç®¡ç†ç³»ç»ŸæŸ¥è¯¢æ€§èƒ½",
  "workitemTypeId": "taskType001",
  "assignedTo": "user123",
  "description": "å¯¹å­¦ç”Ÿä¿¡æ¯æŸ¥è¯¢åŠŸèƒ½è¿›è¡Œæ€§èƒ½ä¼˜åŒ–ï¼Œç›®æ ‡å“åº”æ—¶é—´å°äº100ms",
  "sprint": "sprint001"
}
```

**è¿”å›ç¤ºä¾‹**:
```json
{
  "workItemId": "workitem002",
  "subject": "ä¼˜åŒ–å­¦ç”Ÿç®¡ç†ç³»ç»ŸæŸ¥è¯¢æ€§èƒ½",
  "identifier": "TASK-123",
  "status": "å¾…å¤„ç†",
  "createdAt": "2025-10-16T11:00:00Z"
}
```

**ä½¿ç”¨åœºæ™¯**:
- å¿«é€Ÿåˆ›å»ºå¼€å‘ä»»åŠ¡
- æäº¤BugæŠ¥å‘Š
- è®°å½•éœ€æ±‚

---

### ç¤ºä¾‹8: è¿è¡Œæµæ°´çº¿

**å·¥å…·åç§°**: `mcp_yunxiao_create_pipeline_run`

**ç”¨é€”**: è§¦å‘æµæ°´çº¿æ‰§è¡Œ

**è°ƒç”¨å‚æ•°**:
```json
{
  "organizationId": "org789",
  "pipelineId": "pipeline001",
  "branchMode": false,
  "branches": ["master"]
}
```

**è¿”å›ç¤ºä¾‹**:
```json
{
  "pipelineRunId": "run001",
  "status": "RUNNING",
  "startTime": "2025-10-16T12:00:00Z"
}
```

**ä½¿ç”¨åœºæ™¯**:
- æ‰‹åŠ¨è§¦å‘éƒ¨ç½²
- æ‰§è¡Œè‡ªåŠ¨åŒ–æµ‹è¯•
- æ„å»ºå‘å¸ƒç‰ˆæœ¬

---

## ğŸ“Š å¸¸è§ä½¿ç”¨æµç¨‹

### æµç¨‹1: æŸ¥çœ‹æˆ‘çš„å¾…åŠä»»åŠ¡

```plaintext
1. è°ƒç”¨ get_current_user è·å–ç”¨æˆ·ä¿¡æ¯
2. è°ƒç”¨ get_current_organization_info è·å–ç»„ç»‡ID
3. è°ƒç”¨ search_projects è·å–æˆ‘å‚ä¸çš„é¡¹ç›®
4. å¯¹æ¯ä¸ªé¡¹ç›®è°ƒç”¨ search_workitems
   - category: "Task"
   - assignedTo: "self"
   - status: è¿‡æ»¤è¿›è¡Œä¸­çš„çŠ¶æ€
```

### æµç¨‹2: åˆ›å»ºå¹¶è·Ÿè¸ªBug

```plaintext
1. è·å–ç»„ç»‡IDå’Œé¡¹ç›®ID
2. è°ƒç”¨ create_work_item åˆ›å»ºBug
   - category: "Bug"
   - å¡«å†™è¯¦ç»†æè¿°å’Œé‡ç°æ­¥éª¤
3. å®šæœŸè°ƒç”¨ get_work_item æŸ¥çœ‹å¤„ç†è¿›åº¦
4. Bugä¿®å¤åæ›´æ–°çŠ¶æ€
```

### æµç¨‹3: ç›‘æ§ä»£ç éƒ¨ç½²

```plaintext
1. è°ƒç”¨ list_repositories æ‰¾åˆ°ç›®æ ‡ä»“åº“
2. è°ƒç”¨ list_pipelines æŸ¥çœ‹ç›¸å…³æµæ°´çº¿
3. è°ƒç”¨ create_pipeline_run è§¦å‘éƒ¨ç½²
4. è½®è¯¢ get_pipeline_run ç›‘æ§æ‰§è¡ŒçŠ¶æ€
5. æŸ¥çœ‹ get_pipeline_job_run_log åˆ†ææ—¥å¿—
```

---

## ğŸ’¡ æœ€ä½³å®è·µ

### 1. é”™è¯¯å¤„ç†
- å§‹ç»ˆæ£€æŸ¥è¿”å›çŠ¶æ€ç 
- å¤„ç†è®¤è¯å¤±è´¥ï¼ˆ401é”™è¯¯ï¼‰
- å®ç°é‡è¯•æœºåˆ¶

### 2. æ€§èƒ½ä¼˜åŒ–
- ä½¿ç”¨åˆ†é¡µé¿å…ä¸€æ¬¡æ€§åŠ è½½å¤§é‡æ•°æ®
- ç¼“å­˜organizationIdç­‰å¸¸ç”¨ä¿¡æ¯
- åˆç†è®¾ç½®æŸ¥è¯¢æ¡ä»¶

### 3. å®‰å…¨å»ºè®®
- ä¸è¦åœ¨ä»£ç ä¸­ç¡¬ç¼–ç è®¿é—®ä»¤ç‰Œ
- å®šæœŸæ›´æ¢è®¿é—®ä»¤ç‰Œ
- ä½¿ç”¨æœ€å°æƒé™åŸåˆ™

### 4. æ•°æ®ç®¡ç†
- åŠæ—¶æ¸…ç†è¿‡æœŸæ•°æ®
- å®šæœŸå¤‡ä»½é‡è¦ä¿¡æ¯
- ä½¿ç”¨ç»Ÿä¸€çš„å‘½åè§„èŒƒ

---

## ğŸ”— ç›¸å…³èµ„æº

- **äº‘æ•ˆå®˜æ–¹æ–‡æ¡£**: https://help.aliyun.com/product/153742.html
- **APIå‚è€ƒ**: https://next.api.aliyun.com/api/devops
- **ç¤ºä¾‹ä»£ç **: `yunxiao_demo.py`

---

## ğŸ“ ç¤ºä¾‹æ‰§è¡Œç»“æœ

ä»¥ä¸‹æ˜¯å®é™…è¿è¡Œ `yunxiao_demo.py` çš„è¾“å‡ºç¤ºä¾‹ï¼š

```
************************************************************
äº‘æ•ˆï¼ˆYunxiaoï¼‰API å·¥å…·ä½¿ç”¨ç¤ºä¾‹
************************************************************

ç¤ºä¾‹1: è·å–å½“å‰ç”¨æˆ·ä¿¡æ¯
- å·¥å…·: get_current_user
- ç”¨é€”: éªŒè¯èº«ä»½ã€è·å–ç”¨æˆ·ID

ç¤ºä¾‹2: è·å–ç»„ç»‡ä¿¡æ¯
- å·¥å…·: get_current_organization_info  
- ç”¨é€”: è·å–organizationId

[æ›´å¤šç¤ºä¾‹è¾“å‡º...]
```

---

## â“ å¸¸è§é—®é¢˜

### Q1: è®¤è¯å¤±è´¥æ€ä¹ˆåŠï¼Ÿ
**A**: æ£€æŸ¥è®¿é—®ä»¤ç‰Œæ˜¯å¦æœ‰æ•ˆï¼Œç¡®è®¤æ˜¯å¦è¿‡æœŸï¼Œé‡æ–°ç”Ÿæˆä»¤ç‰Œã€‚

### Q2: æ‰¾ä¸åˆ°organizationIdï¼Ÿ
**A**: ç™»å½•äº‘æ•ˆåå° â†’ ç»„ç»‡è®¾ç½® â†’ åŸºæœ¬ä¿¡æ¯ï¼Œå¯ä»¥çœ‹åˆ°ç»„ç»‡IDã€‚

### Q3: å¦‚ä½•è·å–workitemTypeIdï¼Ÿ
**A**: è°ƒç”¨ `list_work_item_types` å·¥å…·æŸ¥çœ‹é¡¹ç›®ä¸­å¯ç”¨çš„å·¥ä½œé¡¹ç±»å‹ã€‚

### Q4: æµæ°´çº¿è¿è¡Œå¤±è´¥å¦‚ä½•æ’æŸ¥ï¼Ÿ
**A**: ä½¿ç”¨ `get_pipeline_job_run_log` æŸ¥çœ‹è¯¦ç»†æ—¥å¿—ï¼Œæ£€æŸ¥é…ç½®å’Œæƒé™ã€‚

---

**æœ€åæ›´æ–°**: 2025-10-16  
**ç‰ˆæœ¬**: 1.0
